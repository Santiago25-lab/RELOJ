<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reloj con Flask</title>
    <style>
        /* Estilos para centrar y dar fondo a la página */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #2c3e50; /* Fondo gris oscuro */
            font-family: 'Inter', sans-serif;
            margin: 0;
        }

        /* Estilos del contenedor principal del reloj */
        .clock {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: #ffffff; /* Fondo blanco para el reloj */
            border: 10px solid #ecf0f1;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            position: relative;
        }

        .clock-face {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Estilos para las manecillas */
        .hand {
            width: 50%;
            background: black;
            height: 4px;
            position: absolute;
            top: 50%;
            transform-origin: 100%;
            transform: rotate(90deg); /* Posición inicial */
            transition: transform 0.2s cubic-bezier(0.4, 2.3, 0.6, 1);
            border-radius: 2px;
        }
        .hour-hand { width: 35%; left: 15%; height: 6px; }
        .min-hand { width: 45%; left: 5%; height: 4px; }
        .second-hand { width: 48%; left: 2%; background: #e74c3c; height: 2px; }

        /* Punto central */
        .center-dot {
            width: 12px;
            height: 12px;
            background: #e74c3c;
            border: 2px solid white;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        /* Estilos para los números */
        .number {
            position: absolute;
            width: 100%;
            height: 100%;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #34495e;
        }
        .number-1 { transform: rotate(30deg); } .number-2 { transform: rotate(60deg); }
        .number-3 { transform: rotate(90deg); } .number-4 { transform: rotate(120deg); }
        .number-5 { transform: rotate(150deg); } .number-6 { transform: rotate(180deg); }
        .number-7 { transform: rotate(210deg); } .number-8 { transform: rotate(240deg); }
        .number-9 { transform: rotate(270deg); } .number-10 { transform: rotate(300deg); }
        .number-11 { transform: rotate(330deg); } .number-12 { transform: rotate(0deg); }
        .number span {
            display: inline-block;
            transform: rotate(calc(-1 * var(--rotation)));
        }
    </style>
</head>
<body>
    <div class="clock">
        <div class="center-dot"></div>
        <div class="clock-face">
            <div class="hand hour-hand"></div>
            <div class="hand min-hand"></div>
            <div class="hand second-hand"></div>

            <!-- Números del Reloj -->
            <div class="number number-1" style="--rotation: 30deg"><span>1</span></div>
            <div class="number number-2" style="--rotation: 60deg"><span>2</span></div>
            <div class="number number-3" style="--rotation: 90deg"><span>3</span></div>
            <div class="number number-4" style="--rotation: 120deg"><span>4</span></div>
            <div class="number number-5" style="--rotation: 150deg"><span>5</span></div>
            <div class="number number-6" style="--rotation: 180deg"><span>6</span></div>
            <div class="number number-7" style="--rotation: 210deg"><span>7</span></div>
            <div class="number number-8" style="--rotation: 240deg"><span>8</span></div>
            <div class="number number-9" style="--rotation: 270deg"><span>9</span></div>
            <div class="number number-10" style="--rotation: 300deg"><span>10</span></div>
            <div class="number number-11" style="--rotation: 330deg"><span>11</span></div>
            <div class="number number-12" style="--rotation: 0deg"><span>12</span></div>
        </div>
    </div>

    <script>
        const hourHand = document.querySelector('.hour-hand');
        const minHand = document.querySelector('.min-hand');
        const secondHand = document.querySelector('.second-hand');

        async function setDate() {
            try {
                // Pide la hora a nuestro backend de Flask
                const response = await fetch('/time');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                // Extrae los datos
                const { hour, minute, second } = data;

                // Calcula los grados para cada manecilla
                const secondsDegrees = ((second / 60) * 360) + 90;
                const minsDegrees = ((minute / 60) * 360) + ((second/60)*6) + 90;
                const hourDegrees = ((hour / 12) * 360) + ((minute/60)*30) + 90;

                // Aplica la rotación a los estilos CSS
                secondHand.style.transform = `rotate(${secondsDegrees}deg)`;
                minHand.style.transform = `rotate(${minsDegrees}deg)`;
                hourHand.style.transform = `rotate(${hourDegrees}deg)`;

            } catch (error) {
                console.error("Error al obtener la hora:", error);
            }
        }

        // Llama a la función cada segundo
        setInterval(setDate, 1000);

        // Llama a la función una vez al cargar para evitar el retraso inicial
        setDate();
    </script>
</body>
</html>